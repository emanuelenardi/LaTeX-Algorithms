% using titletoc we redefine the ToC entries for chapters, sections, and subsections
\titlecontents{chapter}
    [0em]%
	{\vspace*{2\baselineskip}}%
    {\begin{minipage}{\textwidth}%
        \parbox{4.5em}{%
    		\hfill\Huge\sffamily\bfseries\color{myred}\thecontentspage}%
   			\vspace*{-2.3\baselineskip}\leftbar\textsc{\small\appendixname~\thecontentslabel}\\%
			\sffamily}%
    {\begin{minipage}{\textwidth}%
        \parbox{4.5em}{%
          \hfill\Huge\sffamily\bfseries\color{myred}\thecontentspage}%
        \vspace*{-2.3\baselineskip}\leftbar\textsc{}\\%
        \sffamily}%
	{\endleftbar\end{minipage}\nopagebreak}%
    [\vskip2pt\nopagebreak]

\titleformat{\chapter}[block]% shape
	{\normalfont\scshape\huge}% format
	{\centering \appendixname~\thechapter\\}% The Chapter NÂ° label
	{0pt}% sep
	{\centering \ruleline{\otherfancydraw}\\% The horizontal rule
	\centering #1}% And the actual title